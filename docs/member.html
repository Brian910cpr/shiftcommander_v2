<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ShiftCommander — Member Scheduling</title>

<style>
:root{
  --bg:#0b1020;
  --card:#111a33;
  --card2:rgba(255,255,255,.045);
  --line:rgba(255,255,255,.12);
  --text:#eaf1ff;
  --muted:rgba(234,241,255,.55);

  --pref:#2bd27e;
  --avail:#5c8dff;
  --no:#ff5d5d;
  --clear: rgba(255,255,255,.18);

  --warn:#f4c542;
}

*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui}

/* Top header */
header{
  position:sticky;top:0;z-index:10;
  background:linear-gradient(180deg,#050814,#050814cc);
  border-bottom:1px solid var(--line);
  padding:10px 14px;
  display:flex;gap:12px;align-items:center;flex-wrap:wrap;
}

.pill{
  background:rgba(255,255,255,.06);
  border:1px solid var(--line);
  border-radius:999px;
  padding:6px 10px;
  font-size:13px;
  white-space:nowrap;
  flex-shrink:0;
}
  .pill.btn{ cursor:pointer; user-select:none; }

select{
  min-width:240px;
  font-size:14px;
  background:rgba(255,255,255,.04);
  color:var(--text);
  border:1px solid var(--line);
  border-radius:10px;
  padding:6px 8px;
}

/* Save pill (quiet) */
.savePill{
  display:flex; align-items:center; gap:10px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04);
  border-radius:999px;
  padding:6px 10px;
  min-height:34px;
  cursor: default;
  margin-left:auto;
  max-width: 220px;
}
.savePill .tiny{
  font-size:12px;
  color: rgba(234,241,255,.70);
  min-width:0;
  overflow:hidden;
  white-space:nowrap;
  text-overflow:ellipsis;
  line-height:1;
}
.dot{
  width:10px; height:10px; border-radius:999px;
  background: rgba(233,241,255,.26);
  box-shadow: 0 0 0 3px rgba(255,255,255,.06);
}
.dot.ok{ background:#2bd27e; box-shadow: 0 0 0 3px rgba(43,210,126,.16); }
.dot.warn{ background:var(--warn); box-shadow: 0 0 0 3px rgba(244,197,66,.16); }

/* Tabs */
.tabbar{
  display:flex;
  gap:8px;
  padding:10px 12px 0;
}
.tabbtn{
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04);
  color: var(--text);
  padding: 8px 10px;
  border-radius: 12px;
  font-weight: 900;
  font-size: 12px;
  cursor: pointer;
  user-select:none;
}
.tabbtn:hover{border-color:rgba(255,255,255,.22)}
.tabbtn.active{
  background: rgba(92,141,255,.18);
  border-color: rgba(92,141,255,.35);
}
main{ padding:12px; }
.tab{ display:none; }
.tab.active{ display:block; }

/* Panels */
.panel{
  background: var(--card2);
  border: 1px solid rgba(255,255,255,.10);
  border-radius: 14px;
  padding: 10px;
  margin-bottom: 12px;
}
.panelTitle{
  font-weight: 900;
  font-size: 13px;
  margin-bottom: 6px;
}
.panelHint{
  color: var(--muted);
  font-size: 12px;
  line-height: 1.25;
}

/* Toggle row */
.togRow{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
  margin-top:8px;
}
.toggle{
  display:flex;
  gap:8px;
  align-items:center;
  padding:8px 10px;
  border-radius: 12px;
  background: rgba(255,255,255,.04);
  border:1px solid rgba(255,255,255,.10);
}
.toggle input{ transform: scale(1.1); }
.toggle .lbl{ font-weight: 900; font-size: 12px; }
.toggle .sub{ font-size: 11px; color: var(--muted); margin-top:2px; line-height:1.2; }
.toggle .col{ display:flex; flex-direction:column; }

/* Bulk tools */
.bulkGrid{
  margin-top:8px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:flex-end;
}
.bulkField{display:flex;flex-direction:column;gap:4px}
.bulkField span{font-size:11px;color:var(--muted)}
.bulkField select, .bulkField input{
  background: rgba(255,255,255,.04);
  color: var(--text);
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 10px;
  padding: 6px 8px;
  min-width: 160px;
}
.bulkBtns{display:flex;gap:8px;align-items:flex-end;flex-wrap:wrap}
.bbtn{
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.04);
  color: var(--text);
  padding: 7px 10px;
  border-radius: 10px;
  font-weight: 900;
  font-size: 12px;
  cursor: pointer;
}
.bbtn:hover{border-color:rgba(255,255,255,.25)}
.bbtn.primary{background: rgba(92,141,255,.18); border-color: rgba(92,141,255,.35)}
.bbtn.danger{background: rgba(255,93,93,.16); border-color: rgba(255,93,93,.30)}
.bbtn.ghost{background: rgba(255,255,255,.03); border-color: rgba(255,255,255,.12)}

/* Calendar month layout */
.monthRow{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:12px;
  margin-bottom:12px;
}
.month{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:14px;
  padding:8px;
}
.month h3{
  margin:2px 0 6px;
  font-size:14px;
  font-weight:900;
  text-align:center;
}
.dow{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  font-size:10px;
  color:var(--muted);
  text-align:center;
  margin-bottom:4px;
}
.grid{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:4px;
  align-content:start;
}

/* Day cells */
.day{
  height:30px;
  border:1px solid var(--line);
  border-radius:10px;
  padding:3px 4px;
  display:flex;
  flex-direction:row;
  align-items:center;
  gap:6px;
}
.day.blank{border:none;background:none}
.day.past{opacity:.35;pointer-events:none}

/* day number */
.dayNum{
  width:16px;
  text-align:right;
  font-size:11px;
  font-weight:900;
  line-height:1;
  cursor:pointer;
}

/* pill stack */
.bars{
  display:flex;
  flex-direction:column;
  gap:3px;
  align-items:flex-start;
}
.bar{
  width:34px;
  height:10px;
  border-radius:999px;
  cursor:pointer;
  background: var(--clear);
  border: 1px solid rgba(255,255,255,.25);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:9px;
  font-weight:900;
  line-height:1;
  letter-spacing:0.2px;
  color: rgba(255,255,255,.80);
  user-select:none;
}
.bar::after{ content: attr(data-label); }
.bar.pref{ background:var(--pref); border-color:var(--pref); color: rgba(0,0,0,.70); }
.bar.avail{ background:var(--avail); border-color:var(--avail); color: rgba(0,0,0,.70); }
.bar.no{ background:var(--no); border-color:var(--no); color: rgba(0,0,0,.70); }
.bar:not(.pref):not(.avail):not(.no){ opacity:.75; }

/* Preferences tab list */
.searchRow{
  display:flex; gap:10px; align-items:center; flex-wrap:wrap;
  margin: 8px 0 10px;
}
.searchRow input{
  background: rgba(255,255,255,.04);
  color: var(--text);
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 10px;
  padding: 7px 10px;
  min-width: 260px;
}
.roster{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:8px;
}
.person{
  display:flex;
  gap:8px;
  align-items:center;
  padding:8px 10px;
  border-radius: 12px;
  background: rgba(255,255,255,.04);
  border: 1px solid rgba(255,255,255,.10);
}
.person .name{ font-weight: 900; font-size: 12px; }
.person .meta{ font-size: 11px; color: var(--muted); }

/* Impact tab */
.weekBlock{
  border:1px solid rgba(255,255,255,.12);
  border-radius: 14px;
  padding: 10px;
  background: rgba(255,255,255,.03);
  margin-bottom: 10px;
  position: relative;
}
.weekTag{
  display:inline-flex;
  gap:8px;
  align-items:center;
  font-weight: 900;
  font-size: 12px;
  margin-bottom: 6px;
}
.bracket{
  position:absolute;
  top:10px;
  bottom:10px;
  width:10px;
  border-radius: 10px;
  opacity: .9;
}
.bracket.left{ left:10px; }
.bracket.right{ right:10px; }
.bracket.active{ background: rgba(255,255,255,.65); }
.bracket.controlled{ background: rgba(255,255,255,.25); }
.bracket.published{ background: rgba(43,210,126,.60); }
.bracket.planning{ background: rgba(43,210,126,.18); border:1px dashed rgba(43,210,126,.30); background-clip: padding-box; }

.weekInner{ padding-left: 22px; padding-right: 22px; }
.shiftList{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:8px;
}
.shiftCard{
  border:1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.04);
  border-radius: 12px;
  padding: 8px 10px;
}
.shiftCard .t{ font-weight: 900; font-size: 12px; }
.shiftCard .s{ color: var(--muted); font-size: 11px; margin-top: 2px; }
.badgeWarn{
  display:inline-flex;
  gap:6px;
  align-items:center;
  margin-top: 6px;
  font-size: 11px;
  font-weight: 900;
  color: rgba(244,197,66,.95);
}
.smallNote{ font-size: 11px; color: var(--muted); margin-top: 8px; line-height:1.25; }
</style>
</head>

<body>

<header>
  <div class="pill">Member Scheduling</div>

  <div class="pill">
    Member:
    <select id="member"></select>
  </div>

  <div class="pill" id="rosterPill" title="Roster source: unknown">Roster: <span id="rosterTip">…</span></div>

  <div class="savePill" id="savepill" title="Checking…">
    <span class="dot warn" id="driveDot"></span>
    <span class="tiny" id="driveTip">Checking…</span>
  </div>
  <button class="pill btn" id="btnToken" title="Set/clear SC_TOKEN for Drive saves">Token</button>
</header>

<div class="tabbar">
  <div class="tabbtn active" data-tab="tabAvail">Availability</div>
  <div class="tabbtn" data-tab="tabPrefs">Preferences</div>
  <div class="tabbtn" data-tab="tabImpact">Impact</div>
</div>

<main>
  <!-- Availability -->
  <section id="tabAvail" class="tab active">
    <div class="panel">
      <div class="panelTitle">Global preferences</div>
      <div class="panelHint">
        These don’t block staffing — they simply help the solver break ties and reduce friction.
      </div>

      <div class="togRow">
        <label class="toggle">
          <input id="chkPrefer24" type="checkbox">
          <span class="col">
            <span class="lbl">Prefer 24-hour shifts</span>
            <span class="sub">Small bonus for AM↔PM or PM→next AM continuity when possible.</span>
          </span>
        </label>

        <label class="toggle">
          <input id="chkBlankOk" type="checkbox" checked>
          <span class="col">
            <span class="lbl">If I left a day blank, you may still schedule me if needed</span>
            <span class="sub">Blank stays eligible (0 points). Turn off if you don’t want “lingering zero” pull-ins.</span>
          </span>
        </label>
      </div>
    </div>

    <div class="panel">
      <div class="panelTitle">Quick Set (Bulk)</div>
      <div class="panelHint">Stamp a baseline fast, then click pills below to fine-tune exceptions.</div>

      <div class="bulkGrid">
        <label class="bulkField">
          <span>Pattern</span>
          <select id="bulkPattern">
            <option value="week1">Repeat 1-week template</option>
            <option value="week2">Alternate 2-week templates</option>
          </select>
        </label>

        <label class="bulkField">
          <span>From</span>
          <input id="bulkFrom" type="date">
        </label>

        <label class="bulkField">
          <span>To</span>
          <input id="bulkTo" type="date">
        </label>

        <div class="bulkBtns">
          <button id="btnRepeatUntil" class="bbtn primary" type="button">Copy this week → until date</button>
          <button id="btnApplyRange" class="bbtn ghost" type="button">Apply pattern to range</button>
